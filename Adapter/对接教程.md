## 微信客服对接简明教程

1.访问微信客服网址并注册开通 https://kf.weixin.qq.com/  
2.在“客服账号”创建一个客服账号  
3.在“开发配置”修改回调配置，回调URL填“无界地址/api/bot/wxWorkKF”，Token和EncodingAESKey随机生成，先不要点“完成”  
4.在无界安装依赖got @wecom/crypto xml2js form-data express-xml-bodyparser，重启无界，确保适配器正常加载  
5.进入无界的WEB配置页面，启用适配器并填入corpId（企业ID）corpSecret（Secret）和encodingAESKey，保存    
6.回到第3步的页面，点击完成，如提示成功则对接完成    
7.在“开始接入”点击“在微信内其他场景接入”可以看到客服账号的链接，微信里点击这个链接就可以开启对话
  
**注意：**
1.要启用管理员功能请在已有管理员权限的平台输入set wxWorkKF admin 用户ID,给客服发送消息的时候在控制台可以看到用户ID    
2.微信客服独立版和原来的企业微信客服不能共存，已经开通的需要去原来的企业微信把微信客服停用  
3.有反馈说新开通的账号第5步的时候找不到corpSecret（Secret），要等第6步完成后才能出来，大家自测  
4.第6步无法顺利完成的话可以在点击时候打开无界控制台看有没有收到请求，能收到请求可能是因为无界响应太慢（需要1秒以内），请自行优化  

## 企业微信对接简明教程

1.访问企业微信网址并注册开通 https://work.weixin.qq.com/wework_admin/loginpage_wx  
2.在“应用管理”-“自建”创建一个应用，在“我的企业”获取企业ID并记录  
3.进入应用，获取Secret值并记录，在“开发者接口”设置企业可信IP为无界机器人的外网IP
4.在“功能”-“接收消息”启用API接收。修改回调配置，回调URL填“无界地址/api/bot/wxWork”，Token和EncodingAESKey随机生成，先不要点“完成”  
5.在无界安装依赖got @wecom/crypto xml2js form-data express-xml-bodyparser，重启无界，确保适配器正常加载  
6.进入无界的WEB配置页面，启用适配器并填入 企业ID Secret和encodingAESKey，保存    
7.回到第4步的页面，点击完成，如提示成功则对接完成    
8.在“企业微信”客户端-“工作台”可以找到应用，开启对话，之后也可以在微信端点击进入对话  
  
**注意：**
1.要启用管理员功能请在已有管理员权限的平台输入set wxWork admin 用户ID,给客服发送消息的时候在控制台可以看到用户ID    
2.第7步无法顺利完成的话可以在点击时候打开无界控制台看有没有收到请求，能收到请求可能是因为无界响应太慢（需要1秒以内），请自行优化  
3.微信里无法收到企业微信消息的需要去企业微信后台“我的企业”-“微信插件”-“设置”勾选“允许成员在微信插件中接收和回复聊天消息”  

## 微信公众号对接简明教程

1.访问微信公众号网址并注册开通 https://mp.weixin.qq.com/  
2.在“设置与开发”-“基本配置”获取AppID、AppSecret并记录，配置IP白名单   
3.填写服务器配置，回调URL填“无界地址/api/bot/wxMP”，填写Token，随机生成EncodingAESKey，消息加解密方式选“明文模式”，先不要点“完成”  
4.在无界安装依赖got form-data express-xml-bodyparser，重启无界，确保适配器正常加载  
5.进入无界的WEB配置页面，启用适配器并填入 AppID AppSecret Token EncodingAESKey，保存    
6.回到第3步的页面，点击完成，如提示成功则对接完成  
  
**注意：**
1.要启用管理员功能请在已有管理员权限的平台输入set wxMP admin 用户ID,给客服发送消息的时候在控制台可以看到用户ID    
2.第6步无法顺利完成的话可以在点击时候打开无界控制台看有没有收到请求，能收到请求可能是因为无界响应太慢（需要1秒以内），请自行优化  
3.因腾讯对未认证订阅号的限制，只能在用户发送消息的时候被动回复，回复消息只能“一问一答”，且需要在收到消息内5秒应答，如果你的消息发出去以后有多条回复，只会回复第1条，其他消息需要手动拉取       
    
------------------------2024.09.07新增---------------------------------    
    
微信公众号1.0.6版新增了转发服务器功能，如果你的无界没有固定ip，但是刚好有一台固定ip的服务器，可以通过转发服务器来对接公众号
教程如下：   
1.在服务器上新建容器，命令 docker run -d --restart always -e BNCR_API="无界地址/api/bot/wxMP" -p 80:5050 --name wxmp-fwd merrick/wxmp-fwd:latest ，拉取完毕访问“服务器地址/api/status”，如果显示“中转服务器访问正常……”的字样，代表中转服务器搭建成功   
注意：公众号要求对接端口是80或443，如果你服务器的端口被占用了可以自行搭建反代    
2.进入公众号后台，回调URL填“服务器地址/api/fwd-bncr”,其他保持不变，点击保存（详见对接教程第6步）。保存成功以后就可以通过中转服务器发送文字消息了，需要发送图片等多媒体的继续下一步   
3.进入无界的WEB配置页面，启用转发服务器并填入服务器地址（就是你拉取镜像的服务器，如： http://mydomain.com ，不带后面的/）并保存   
4.重启无界后就可以正常发送消息   
对接失败的排查方法：   
当你在微信端发送消息后，消息是按“腾讯服务器→中转服务器→无界”的路径走的，中转服务器可以在容器日志里查看有没有收到消息，无界可以在控制台查看有没有收到消息，按流程逐个排查。当你在微信端请求图片的时候，无界收到消息后按“发送图片链接→获取图片信息→传递给中转服务器→上传到腾讯服务器→返回图片ID经中转服务器至无界→发送图片ID经中转服务器至腾讯服务器→微信端”的步骤进行的，按流程逐个排查。    
还有问题可以进群咨询，https://t.me/+V2q6Okh6GupiNGI1

------------------------2024.11.05新增---------------------------------
## wechatFerry对接简明教程

1.访问 https://github.com/lich0821/wcf-client-rust 下载对应版本的微信客户端和wcf客户端，安装并配置端口和回调地址（目前测试Win7不兼容，Win10可以，其他系统未测试）  
2.下载适配器并配置上报地址，测试的got版本为11.8.5，xml2js版本0.6.2，其他自行测试   
3.在wfc配置的服务器打开fileServer.exe，文件服务器默认端口为9900，默认下载地址为C:\wxFiles，如需修改下载config.ini文件并配置（服务器地址不强制要求配置，不配置只影响视频的发送）   
4.配置文件服务器的情况下，所有发送的图片和视频会保存到C:\wxFiles，不配置的情况下图片会保存到C:\images，记得定时清理   
